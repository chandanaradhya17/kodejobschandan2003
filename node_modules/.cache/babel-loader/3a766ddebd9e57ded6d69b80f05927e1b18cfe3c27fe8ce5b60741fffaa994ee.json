{"ast":null,"code":"import bcrypt from 'bcryptjs';\nconst STORAGE_KEY = 'kodjobs_users';\nclass UserService {\n  constructor() {\n    this.users = this.loadUsers();\n  }\n  loadUsers() {\n    try {\n      const data = localStorage.getItem(STORAGE_KEY);\n      return data ? JSON.parse(data) : [];\n    } catch (error) {\n      console.error('Error loading users:', error);\n      return [];\n    }\n  }\n  saveUsers(users) {\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(users));\n      return true;\n    } catch (error) {\n      console.error('Error saving users:', error);\n      return false;\n    }\n  }\n  async createUser(userData) {\n    try {\n      // Check if user already exists\n      if (this.users.some(user => user.email === userData.email)) {\n        throw new Error('User with this email already exists');\n      }\n\n      // Hash password\n      const hashedPassword = await bcrypt.hash(userData.password, 10);\n\n      // Create new user\n      const newUser = {\n        id: (this.users.length + 1).toString(),\n        name: userData.name,\n        email: userData.email,\n        password: hashedPassword,\n        createdAt: new Date().toISOString()\n      };\n\n      // Add to users array\n      const updatedUsers = [...this.users, newUser];\n\n      // Save to localStorage\n      if (this.saveUsers(updatedUsers)) {\n        this.users = updatedUsers;\n        // Return user without password\n        const {\n          password,\n          ...userWithoutPassword\n        } = newUser;\n        return userWithoutPassword;\n      } else {\n        throw new Error('Failed to save user');\n      }\n    } catch (error) {\n      throw error;\n    }\n  }\n  async validateUser(email, password) {\n    try {\n      const user = this.users.find(u => u.email === email);\n      if (!user) {\n        return null;\n      }\n      const isValid = await bcrypt.compare(password, user.password);\n      if (!isValid) {\n        return null;\n      }\n\n      // Return user without password\n      const {\n        password: _,\n        ...userWithoutPassword\n      } = user;\n      return userWithoutPassword;\n    } catch (error) {\n      throw error;\n    }\n  }\n  getUserByEmail(email) {\n    const user = this.users.find(u => u.email === email);\n    if (!user) return null;\n\n    // Return user without password\n    const {\n      password,\n      ...userWithoutPassword\n    } = user;\n    return userWithoutPassword;\n  }\n  updateUser(userId, updateData) {\n    try {\n      const userIndex = this.users.findIndex(u => u.id === userId);\n      if (userIndex === -1) {\n        throw new Error('User not found');\n      }\n\n      // Don't allow updating certain fields\n      const {\n        id,\n        password,\n        createdAt,\n        ...allowedUpdates\n      } = updateData;\n\n      // Update user\n      const updatedUsers = [...this.users];\n      updatedUsers[userIndex] = {\n        ...updatedUsers[userIndex],\n        ...allowedUpdates\n      };\n\n      // Save changes\n      if (this.saveUsers(updatedUsers)) {\n        this.users = updatedUsers;\n        // Return updated user without password\n        const {\n          password,\n          ...userWithoutPassword\n        } = updatedUsers[userIndex];\n        return userWithoutPassword;\n      } else {\n        throw new Error('Failed to update user');\n      }\n    } catch (error) {\n      throw error;\n    }\n  }\n}\nexport const userService = new UserService();","map":{"version":3,"names":["bcrypt","STORAGE_KEY","UserService","constructor","users","loadUsers","data","localStorage","getItem","JSON","parse","error","console","saveUsers","setItem","stringify","createUser","userData","some","user","email","Error","hashedPassword","hash","password","newUser","id","length","toString","name","createdAt","Date","toISOString","updatedUsers","userWithoutPassword","validateUser","find","u","isValid","compare","_","getUserByEmail","updateUser","userId","updateData","userIndex","findIndex","allowedUpdates","userService"],"sources":["C:/Users/chand/KodJobs/src/services/userService.js"],"sourcesContent":["import bcrypt from 'bcryptjs';\r\n\r\nconst STORAGE_KEY = 'kodjobs_users';\r\n\r\nclass UserService {\r\n  constructor() {\r\n    this.users = this.loadUsers();\r\n  }\r\n\r\n  loadUsers() {\r\n    try {\r\n      const data = localStorage.getItem(STORAGE_KEY);\r\n      return data ? JSON.parse(data) : [];\r\n    } catch (error) {\r\n      console.error('Error loading users:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  saveUsers(users) {\r\n    try {\r\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(users));\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error saving users:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async createUser(userData) {\r\n    try {\r\n      // Check if user already exists\r\n      if (this.users.some(user => user.email === userData.email)) {\r\n        throw new Error('User with this email already exists');\r\n      }\r\n\r\n      // Hash password\r\n      const hashedPassword = await bcrypt.hash(userData.password, 10);\r\n\r\n      // Create new user\r\n      const newUser = {\r\n        id: (this.users.length + 1).toString(),\r\n        name: userData.name,\r\n        email: userData.email,\r\n        password: hashedPassword,\r\n        createdAt: new Date().toISOString()\r\n      };\r\n\r\n      // Add to users array\r\n      const updatedUsers = [...this.users, newUser];\r\n\r\n      // Save to localStorage\r\n      if (this.saveUsers(updatedUsers)) {\r\n        this.users = updatedUsers;\r\n        // Return user without password\r\n        const { password, ...userWithoutPassword } = newUser;\r\n        return userWithoutPassword;\r\n      } else {\r\n        throw new Error('Failed to save user');\r\n      }\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async validateUser(email, password) {\r\n    try {\r\n      const user = this.users.find(u => u.email === email);\r\n      if (!user) {\r\n        return null;\r\n      }\r\n\r\n      const isValid = await bcrypt.compare(password, user.password);\r\n      if (!isValid) {\r\n        return null;\r\n      }\r\n\r\n      // Return user without password\r\n      const { password: _, ...userWithoutPassword } = user;\r\n      return userWithoutPassword;\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  getUserByEmail(email) {\r\n    const user = this.users.find(u => u.email === email);\r\n    if (!user) return null;\r\n    \r\n    // Return user without password\r\n    const { password, ...userWithoutPassword } = user;\r\n    return userWithoutPassword;\r\n  }\r\n\r\n  updateUser(userId, updateData) {\r\n    try {\r\n      const userIndex = this.users.findIndex(u => u.id === userId);\r\n      if (userIndex === -1) {\r\n        throw new Error('User not found');\r\n      }\r\n\r\n      // Don't allow updating certain fields\r\n      const { id, password, createdAt, ...allowedUpdates } = updateData;\r\n\r\n      // Update user\r\n      const updatedUsers = [...this.users];\r\n      updatedUsers[userIndex] = {\r\n        ...updatedUsers[userIndex],\r\n        ...allowedUpdates\r\n      };\r\n\r\n      // Save changes\r\n      if (this.saveUsers(updatedUsers)) {\r\n        this.users = updatedUsers;\r\n        // Return updated user without password\r\n        const { password, ...userWithoutPassword } = updatedUsers[userIndex];\r\n        return userWithoutPassword;\r\n      } else {\r\n        throw new Error('Failed to update user');\r\n      }\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n\r\nexport const userService = new UserService(); "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}